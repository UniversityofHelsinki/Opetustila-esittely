uuid: 52b53f98-53bd-4915-9937-f19a43a2b790
langcode: en
status: true
dependencies:
  enforced:
    module:
      - migrate_plus
_core:
  default_config_hash: sKp_pTf55ZgIg7OWhLEen92DfntR7ROZWaCj88EWsF4
id: optime_integration
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: optime
label: 'JSON import of spaces and related metadata from Optime'
source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: json
  include_raw_data: true
  urls: 'https://helpdesk.it.helsinki.fi/sites/default/files/testdata/test.json'
  item_selector: 0
  fields:
    -
      name: optime_id
      label: 'Unique identifier containing building and space (optime)'
      selector: id
    -
      name: space_description
      label: 'Name or description of space, added to title'
      selector: description
    -
      name: building_description
      label: 'Building description including address, added to title'
      selector: buildingDescription
    -
      name: equipment
      label: 'Equipment terms'
      selector: equipment
    -
      name: campus
      label: 'Campus term (required)'
      selector: campus
    -
      name: building
      label: 'Building term (required)'
      selector: building
  ids:
    optime_id:
      type: string
process:
  type:
    plugin: default_value
    default_value: space
  title:
    plugin: concat
    source:
      - building_description
      - space_description
    delimiter: ' / '
  uid:
    plugin: default_value
    default_value: 1
  field_optime_id: optime_id
  field_campus:
    -
      plugin: entity_generate
      source: campus
      value_key: name
      bundle_key: vid
      bundle: campus
      entity_type: taxonomy_term
      ignore_case: true
  field_building:
    -
      plugin: entity_generate
      source: building_description
      value_key: name
      bundle: building
      entity_type: taxonomy_term
      ignore_case: true
  field_equipment:
    -
      plugin: entity_generate
      source: equipment
      value_key: name
      bundle: equipment
      entity_type: taxonomy_term
      ignore_case: true
destination:
  plugin: 'entity:node'
  default_bundle: space
  bundle: space
migration_dependencies: {  }
